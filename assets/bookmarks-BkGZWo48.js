import{u as R}from"./header-DlD6KKUP.js";const S=document.querySelector(".addNewFolder");console.log(S);const C=document.querySelector(".closeBtn"),I=document.querySelector(".js-backdrop"),N=t=>{document.body.classList.add("show-modal"),document.addEventListener("keydown",u),R()},k=t=>{document.body.classList.remove("show-modal"),document.removeEventListener("keydown",u)},y=()=>{document.body.classList.remove("show-modal"),document.removeEventListener("keydown",u)},U=t=>{t.target===t.currentTarget&&k()},u=t=>{t.code==="Escape"&&k()};S.addEventListener("click",N);C.addEventListener("click",k);I.addEventListener("click",U);const q="/DMark_1.1/assets/folder-DogtCluV.svg";document.addEventListener("DOMContentLoaded",()=>{const t=document.querySelector(".new-folder-form"),i=document.querySelector(".bookmark-list");if(document.querySelector(".reset-bookmarksBtnJS").addEventListener("click",e=>{e.target.classList.add("reset_animation"),confirm("Are you sure you want to delete all bookmarks?")?setTimeout(()=>{e.target.classList.remove("reset_animation"),localStorage.removeItem("dashMarkBookmarks"),location.reload(!0)},1100):alert("Your data is accessible, we have not deleted anything.")}),!t){console.error("Form .new-folder-form not found in DOM — check your HTML or script loading order.");return}i||console.error("Bookmark container .bookmark-list not found.");const f=localStorage.getItem("dashMarkBookmarks");let a=f?JSON.parse(f):[];function h({title:e,url:o}){return`<a href="${d(o)}" target="_blank" rel="noopener noreferrer">${d(e)}</a>`}function B(e){const o=(e.links||[]).map(h).join("");return`
      <li class="slide dash_slide">
        <div class="folder-card">
          <div class="folder-header">
            <img src="${e.icon||q}" alt="folder icon" class="folder-icon"/>
            <span class="folder-name">${d(e.name)}</span>
          </div>
          <div class="folder-preview">
            ${o}
          </div>
        </div>
      </li>
    `}function g(){if(!i)return;const e=a.map(B).join("");i.innerHTML=e}function M(){localStorage.setItem("dashMarkBookmarks",JSON.stringify(a))}function d(e=""){return String(e).replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;")}function F(e){return new Promise((o,s)=>{const n=new FileReader;n.onload=()=>o(n.result),n.onerror=s,n.readAsDataURL(e)})}function D(){const e=[...t.elements].map(o=>({tag:o.tagName,type:o.type,name:o.name,value:o.value,disabled:o.disabled}));console.log("Form elements snapshot:",e)}t.addEventListener("submit",async e=>{e.preventDefault();const o=new FormData(t);console.log("FormData entries:");for(const[r,T]of o.entries())console.log(r,T);const s=o.get("folderName"),n=o.get("bookmarkURL"),p=o.get("bookmarkTitle"),l=o.get("folderIcon"),m=s&&s.toString().trim()||"",c=n&&n.toString().trim()||"",E=p&&p.toString().trim()||c;if(!m){console.warn("Folder name is empty — please fill it"),y();return}if(!c){console.warn("Bookmark URL is empty — please fill it"),alert("Введите URL ссылки");return}try{new URL(c)}catch{alert("Некорректный URL");return}let L="./src/images/folder.svg";if(l&&l instanceof File&&l.size>0)try{L=await F(l)}catch(r){console.warn("Error reading icon file, using default icon",r)}const v={title:E,url:c},w=a.findIndex(r=>r.name.toLowerCase()===m.toLowerCase());if(w!==-1)a[w].links.push(v);else{const r={name:m,icon:L,links:[v]};a.push(r)}M(),g(),t.reset(),y()}),g(),window._dumpFolderForm=D});const b=localStorage.getItem("dashMarkBookmarks"),A=document.querySelector(".BookmarkTitleJS");if(b)try{JSON.parse(b).length>0&&A.classList.add("unvisible")}catch(t){console.error("Error parsing dashMarkBookmarks from localStorage:",t)}else console.log("No bookmarks found in localStorage.");
